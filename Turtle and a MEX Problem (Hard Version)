#include<bits/stdc++.h>
using namespace std;typedef long long ll;const int N=2e5+5;int t,n,m,mx,mx2,f[N];vector<int>nexts[N];ll ans;int main(){cin>>t;while(t--){cin>>n>>m;mx=0,mx2=0,ans=0;for(int i=1;i<=n;i++){int a,b,cnt=0,cnt1=0,pre=0;cin>>a;map<int,int>ma;for(int j=1;j<=a;j++)cin>>b,ma[b]++;for(;ma[cnt]||cnt1==0;cnt++)if(!ma[cnt])cnt1++,pre=cnt,mx2=max(mx2,cnt);mx=max(mx,cnt);nexts[pre].push_back(cnt);}for(int i=mx;i>=0;i--){f[i]=i;for(int k:nexts[i])f[i]=max(f[i],f[k]);mx2=(nexts[i].size()>1&&f[i]>mx2)?f[i]:mx2;nexts[i].clear();}for(int i=0;i<=mx&&i<=m;i++)ans+=max(mx2,f[i]);ans+=(mx<m)?(ll)(mx+1+m)*(m-mx)/2:0;cout<<ans<<"\n";}}
